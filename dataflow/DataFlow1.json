{
	"name": "DataFlow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_Neon_amesdbtemp",
						"type": "DatasetReference"
					},
					"name": "DSNeonamesdbtemp"
				},
				{
					"dataset": {
						"referenceName": "DS_AmesProperty_CSV",
						"type": "DatasetReference"
					},
					"name": "DSAmesProperty"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_SaleProperty",
						"type": "DatasetReference"
					},
					"name": "DSNeonSaleProperty"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_FloorDetail",
						"type": "DatasetReference"
					},
					"name": "DSNeonFloorDetail"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_MsZoning",
						"type": "DatasetReference"
					},
					"name": "DSNeonMsZooning"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_MsSubClass",
						"type": "DatasetReference"
					},
					"name": "DSNeonMsSubClass"
				},
				{
					"dataset": {
						"referenceName": "GarageCSV",
						"type": "DatasetReference"
					},
					"name": "GarageCSV"
				},
				{
					"dataset": {
						"referenceName": "miscCSV",
						"type": "DatasetReference"
					},
					"name": "MiscCSV"
				},
				{
					"dataset": {
						"referenceName": "PoolCSV",
						"type": "DatasetReference"
					},
					"name": "PoolCSV"
				},
				{
					"dataset": {
						"referenceName": "BsmtCSV",
						"type": "DatasetReference"
					},
					"name": "BsmtCSV"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_Join6_Debug",
						"type": "DatasetReference"
					},
					"name": "pruebajoins",
					"rejectedDataLinkedService": {
						"referenceName": "Mongo_Storage",
						"type": "LinkedServiceReference"
					}
				},
				{
					"dataset": {
						"referenceName": "DS_Salida_CSV",
						"type": "DatasetReference"
					},
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "cast1"
				},
				{
					"name": "join1"
				},
				{
					"name": "join2"
				},
				{
					"name": "FloorAgg"
				},
				{
					"name": "join3"
				},
				{
					"name": "join4"
				},
				{
					"name": "join5"
				},
				{
					"name": "LimpiezaNulos"
				},
				{
					"name": "selectMsSubClass"
				},
				{
					"name": "SelectFloorDetail"
				},
				{
					"name": "SelectSaleProperty"
				},
				{
					"name": "SelectMsZoning"
				},
				{
					"name": "selectAmesDb"
				},
				{
					"name": "Transformaciones"
				},
				{
					"name": "selectGarage"
				},
				{
					"name": "selectMisc"
				},
				{
					"name": "selectPool"
				},
				{
					"name": "selectBsmt"
				},
				{
					"name": "join6"
				},
				{
					"name": "join7"
				},
				{
					"name": "join8"
				},
				{
					"name": "join9"
				},
				{
					"name": "select8"
				},
				{
					"name": "DropDupCol"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Exter Cond} as long,",
				"          {Exter Qual} as long,",
				"          {Heating QC} as long,",
				"          {Kitchen Qual} as long,",
				"          {MS Zoning} as long,",
				"          pid as long,",
				"          {Roof Style} as string,",
				"          {Roof Matl} as string,",
				"          {Exterior 1st} as string,",
				"          {Exterior 2nd} as string,",
				"          {Mas Vnr Type} as string,",
				"          {Mas Vnr Area} as long,",
				"          foundation as string,",
				"          heating as string,",
				"          {Central Air} as boolean,",
				"          electrical as string,",
				"          {1st Flr SF} as long,",
				"          {2nd Flr SF} as long,",
				"          {Low Qual Fin SF} as long,",
				"          {Kitchen AbvGr} as long,",
				"          {TotRms AbvGrd} as long,",
				"          functional as string,",
				"          fireplaces as long,",
				"          {Fireplace Qu} as string,",
				"          {Paved Drive} as string,",
				"          {Wood Deck SF} as long,",
				"          {Open Porch SF} as long,",
				"          {Enclosed Porch} as long,",
				"          {3Ssn Porch} as long,",
				"          {Screen Porch} as long,",
				"          fence as string,",
				"          {MS SubClass} as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonamesdbtemp",
				"source(output(",
				"          PID as string,",
				"          {Lot Frontage} as string,",
				"          {Lot Area} as string,",
				"          Street as string,",
				"          Alley as string,",
				"          {Lot Shape} as string,",
				"          {Land Contour} as string,",
				"          Utilities as string,",
				"          {Lot Config} as string,",
				"          {Land Slope} as string,",
				"          Neighborhood as string,",
				"          {Condition 1} as string,",
				"          {Condition 2} as string,",
				"          {Bldg Type} as string,",
				"          {House Style} as string,",
				"          {Overall Qual} as string,",
				"          {Overall Cond} as string,",
				"          {Year Built} as string,",
				"          {Year Remod/Add} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> DSAmesProperty",
				"source(output(",
				"          pid as long,",
				"          {Sale Date} as timestamp,",
				"          {Sale Type} as string,",
				"          {Sale Condition} as string,",
				"          saleprice as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonSaleProperty",
				"source(output(",
				"          pid as long,",
				"          Floor as long,",
				"          bedrooms as long,",
				"          {Full Bath} as long,",
				"          {Half Bath} as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonFloorDetail",
				"source(output(",
				"          id as long,",
				"          description as string,",
				"          code as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonMsZooning",
				"source(output(",
				"          description as string,",
				"          code as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonMsSubClass",
				"source(output(",
				"          {$oid} as string,",
				"          {Order_$numberLong} as short,",
				"          {PID_$numberLong} as long,",
				"          {Garage Type} as string,",
				"          {Garage Yr Blt_$numberLong} as short,",
				"          {Garage Finish} as string,",
				"          {Garage Cars_$numberLong} as short,",
				"          {Garage Area_$numberLong} as short,",
				"          {Garage Qual} as string,",
				"          {Garage Cond} as string",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> GarageCSV",
				"source(output(",
				"          {$oid} as string,",
				"          {PID_$numberLong} as long,",
				"          {Misc Feature} as string,",
				"          {Misc Val_$numberLong} as short",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     limit: 100,",
				"     ignoreNoFilesFound: false) ~> MiscCSV",
				"source(output(",
				"          {$oid} as string,",
				"          {PID_$numberLong} as long,",
				"          {Pool Area_$numberLong} as short,",
				"          {Pool QC} as string",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> PoolCSV",
				"source(output(",
				"          {$oid} as string,",
				"          {PID_$numberLong} as long,",
				"          {Bsmt Qual} as string,",
				"          {Bsmt Cond} as string,",
				"          {Bsmt Exposure} as string,",
				"          {BsmtFin Type 1} as string,",
				"          {BsmtFin SF 1_$numberLong} as short,",
				"          {BsmtFin Type 2} as string,",
				"          {BsmtFin SF 2_$numberLong} as short,",
				"          {Bsmt Unf SF_$numberLong} as short,",
				"          {Total Bsmt SF_$numberLong} as short,",
				"          {Bsmt Full Bath_$numberLong} as short,",
				"          {Bsmt Half Bath_$numberLong} as boolean",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> BsmtCSV",
				"DSAmesProperty cast(output(",
				"          PID as long,",
				"          {Lot Frontage} as integer,",
				"          {Lot Area} as integer,",
				"          {Overall Qual} as integer,",
				"          {Overall Cond} as integer,",
				"          {Year Built} as integer,",
				"          {Year Remod/Add} as integer",
				"     ),",
				"     errors: true) ~> cast1",
				"cast1, selectAmesDb join(cast1@PID == selectAmesDb@PID,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1, SelectSaleProperty join(cast1@PID == SelectSaleProperty@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"SelectFloorDetail aggregate(groupBy(PID),",
				"     TotalFullBath = sum({Full Bath}),",
				"          TotalHalfBath = sum({Half Bath}),",
				"          TotalBedrooms = sum(bedrooms)) ~> FloorAgg",
				"join2, FloorAgg join(cast1@PID == FloorAgg@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join3",
				"join3, SelectMsZoning join({MS Zoning} == id,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join4",
				"join4, selectMsSubClass join({MS SubClass} == {code MsSubClass},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join5",
				"DropDupCol derive(each(match(type=='integer'), $$ = iifNull($$, 0)),",
				"          each(match(type=='string'), $$ = iifNull($$, 'NA')),",
				"          each(match(type=='long'), $$ = iifNull($$, 0))) ~> LimpiezaNulos",
				"DSNeonMsSubClass select(mapColumn(",
				"          {description MsSubClass} = description,",
				"          {code MsSubClass} = code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectMsSubClass",
				"DSNeonFloorDetail select(mapColumn(",
				"          PID = pid,",
				"          Floor,",
				"          bedrooms,",
				"          {Full Bath},",
				"          {Half Bath}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectFloorDetail",
				"DSNeonSaleProperty select(mapColumn(",
				"          PID = pid,",
				"          {Sale Date},",
				"          {Sale Type},",
				"          {Sale Condition},",
				"          saleprice",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectSaleProperty",
				"DSNeonMsZooning select(mapColumn(",
				"          id,",
				"          {description MsZoning} = description,",
				"          {code MsZoning} = code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectMsZoning",
				"DSNeonamesdbtemp select(mapColumn(",
				"          {Exter Cond},",
				"          {Exter Qual},",
				"          {Heating QC},",
				"          {Kitchen Qual},",
				"          {MS Zoning},",
				"          PID = pid,",
				"          {Roof Style},",
				"          {Roof Matl},",
				"          {Exterior 1st},",
				"          {Exterior 2nd},",
				"          {Mas Vnr Type},",
				"          {Mas Vnr Area},",
				"          foundation,",
				"          heating,",
				"          {Central Air},",
				"          electrical,",
				"          {1st Flr SF},",
				"          {2nd Flr SF},",
				"          {Low Qual Fin SF},",
				"          {Kitchen AbvGr},",
				"          {TotRms AbvGrd},",
				"          functional,",
				"          fireplaces,",
				"          {Fireplace Qu},",
				"          {Paved Drive},",
				"          {Wood Deck SF},",
				"          {Open Porch SF},",
				"          {Enclosed Porch},",
				"          {3Ssn Porch},",
				"          {Screen Porch},",
				"          fence,",
				"          {MS SubClass}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectAmesDb",
				"LimpiezaNulos derive({Gr Liv Area} = {1st Flr SF} + {2nd Flr SF} + {Low Qual Fin SF},",
				"          {Mo Sold} = month({Sale Date}),",
				"          {Yr Sold} = year({Sale Date}),",
				"          {Year Remod/Add} = iif({Year Remod/Add} == 0, {Year Built}, {Year Remod/Add})) ~> Transformaciones",
				"GarageCSV select(mapColumn(",
				"          {$oid},",
				"          Order = {Order_$numberLong},",
				"          PID = {PID_$numberLong},",
				"          GarageType = {Garage Type},",
				"          GarageYrBlt = {Garage Yr Blt_$numberLong},",
				"          GarageFinish = {Garage Finish},",
				"          GarageCars = {Garage Cars_$numberLong},",
				"          GarageArea = {Garage Area_$numberLong},",
				"          GarageQual = {Garage Qual},",
				"          GarageCond = {Garage Cond}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectGarage",
				"MiscCSV select(mapColumn(",
				"          {$oid},",
				"          PID = {PID_$numberLong},",
				"          MiscFeature = {Misc Feature},",
				"          MiscVal = {Misc Val_$numberLong}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectMisc",
				"PoolCSV select(mapColumn(",
				"          {$oid},",
				"          PID = {PID_$numberLong},",
				"          PoolArea = {Pool Area_$numberLong},",
				"          PoolQC = {Pool QC}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectPool",
				"BsmtCSV select(mapColumn(",
				"          {$oid},",
				"          PID = {PID_$numberLong},",
				"          BsmtQual = {Bsmt Qual},",
				"          BsmtExposure = {Bsmt Exposure},",
				"          BsmtCond = {Bsmt Cond},",
				"          {BsmtFinType 1} = {BsmtFin Type 1},",
				"          BsmtFinSF1 = {BsmtFin SF 1_$numberLong},",
				"          BsmtFinType2 = {BsmtFin Type 2},",
				"          BsmtFinSF2 = {BsmtFin SF 2_$numberLong},",
				"          BsmtUnfSF = {Bsmt Unf SF_$numberLong},",
				"          TotalBsmtSF = {Total Bsmt SF_$numberLong},",
				"          BsmtFullBath = {Bsmt Full Bath_$numberLong},",
				"          BsmtHalfBath = {Bsmt Half Bath_$numberLong}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectBsmt",
				"Transformaciones, selectGarage join(LimpiezaNulos@PID == selectGarage@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join6",
				"join6, selectPool join(LimpiezaNulos@PID == selectPool@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join7",
				"join7, selectBsmt join(selectGarage@PID == selectBsmt@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join8",
				"join8, selectMisc join(LimpiezaNulos@PID == selectMisc@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join9",
				"join9 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select8",
				"join5 select(mapColumn(",
				"          each(match(/* All input columns */ true()),",
				"               /* Input name */ $$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> DropDupCol",
				"join6 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> pruebajoins",
				"select8 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink2"
			]
		}
	}
}