{
	"name": "DataFlow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_Neon_amesdbtemp",
						"type": "DatasetReference"
					},
					"name": "DSNeonamesdbtemp"
				},
				{
					"dataset": {
						"referenceName": "DS_AmesProperty_CSV",
						"type": "DatasetReference"
					},
					"name": "fuenteCsv"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_SaleProperty",
						"type": "DatasetReference"
					},
					"name": "DSNeonSaleProperty"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_FloorDetail",
						"type": "DatasetReference"
					},
					"name": "DSNeonFloorDetail"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_MsZoning",
						"type": "DatasetReference"
					},
					"name": "DSNeonMsZooning"
				},
				{
					"dataset": {
						"referenceName": "DS_Neon_MsSubClass",
						"type": "DatasetReference"
					},
					"name": "DSNeonMsSubClass"
				},
				{
					"dataset": {
						"referenceName": "GarageCSV",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_Salida_CSV",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "cast1"
				},
				{
					"name": "join1"
				},
				{
					"name": "join2"
				},
				{
					"name": "FloorAgg"
				},
				{
					"name": "join3"
				},
				{
					"name": "join4"
				},
				{
					"name": "join5"
				},
				{
					"name": "LimpiezaNulos"
				},
				{
					"name": "select2"
				},
				{
					"name": "select3"
				},
				{
					"name": "select4"
				},
				{
					"name": "select5"
				},
				{
					"name": "select6"
				},
				{
					"name": "select7"
				},
				{
					"name": "Transformaciones"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Exter Cond} as long,",
				"          {Exter Qual} as long,",
				"          {Heating QC} as long,",
				"          {Kitchen Qual} as long,",
				"          {MS Zoning} as long,",
				"          pid as long,",
				"          {Roof Style} as string,",
				"          {Roof Matl} as string,",
				"          {Exterior 1st} as string,",
				"          {Exterior 2nd} as string,",
				"          {Mas Vnr Type} as string,",
				"          {Mas Vnr Area} as long,",
				"          foundation as string,",
				"          heating as string,",
				"          {Central Air} as boolean,",
				"          electrical as string,",
				"          {1st Flr SF} as long,",
				"          {2nd Flr SF} as long,",
				"          {Low Qual Fin SF} as long,",
				"          {Kitchen AbvGr} as long,",
				"          {TotRms AbvGrd} as long,",
				"          functional as string,",
				"          fireplaces as long,",
				"          {Fireplace Qu} as string,",
				"          {Paved Drive} as string,",
				"          {Wood Deck SF} as long,",
				"          {Open Porch SF} as long,",
				"          {Enclosed Porch} as long,",
				"          {3Ssn Porch} as long,",
				"          {Screen Porch} as long,",
				"          fence as string,",
				"          {MS SubClass} as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonamesdbtemp",
				"source(output(",
				"          PID as string,",
				"          {Lot Frontage} as string,",
				"          {Lot Area} as string,",
				"          Street as string,",
				"          Alley as string,",
				"          {Lot Shape} as string,",
				"          {Land Contour} as string,",
				"          Utilities as string,",
				"          {Lot Config} as string,",
				"          {Land Slope} as string,",
				"          Neighborhood as string,",
				"          {Condition 1} as string,",
				"          {Condition 2} as string,",
				"          {Bldg Type} as string,",
				"          {House Style} as string,",
				"          {Overall Qual} as string,",
				"          {Overall Cond} as string,",
				"          {Year Built} as string,",
				"          {Year Remod/Add} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> fuenteCsv",
				"source(output(",
				"          pid as long,",
				"          {Sale Date} as timestamp,",
				"          {Sale Type} as string,",
				"          {Sale Condition} as string,",
				"          saleprice as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonSaleProperty",
				"source(output(",
				"          pid as long,",
				"          Floor as long,",
				"          bedrooms as long,",
				"          {Full Bath} as long,",
				"          {Half Bath} as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonFloorDetail",
				"source(output(",
				"          id as long,",
				"          description as string,",
				"          code as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonMsZooning",
				"source(output(",
				"          description as string,",
				"          code as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DSNeonMsSubClass",
				"source(output(",
				"          {$oid} as string,",
				"          {Order_$numberLong} as short,",
				"          {PID_$numberLong} as integer,",
				"          {Garage Type} as string,",
				"          {Garage Yr Blt_$numberLong} as short,",
				"          {Garage Finish} as string,",
				"          {Garage Cars_$numberLong} as short,",
				"          {Garage Area_$numberLong} as short,",
				"          {Garage Qual} as string,",
				"          {Garage Cond} as string",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     limit: 100,",
				"     ignoreNoFilesFound: false) ~> source1",
				"fuenteCsv cast(output(",
				"          PID as long,",
				"          {Lot Frontage} as integer,",
				"          {Lot Area} as integer,",
				"          {Overall Qual} as integer,",
				"          {Overall Cond} as integer,",
				"          {Year Built} as integer,",
				"          {Year Remod/Add} as integer",
				"     ),",
				"     errors: true) ~> cast1",
				"cast1, select6 join(cast1@PID == select6@PID,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1, select4 join(cast1@PID == select4@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"select3 aggregate(groupBy(PID),",
				"     TotalFullBath = sum({Full Bath}),",
				"          TotalHalfBath = sum({Half Bath}),",
				"          TotalBedrooms = sum(bedrooms)) ~> FloorAgg",
				"join2, FloorAgg join(cast1@PID == FloorAgg@PID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join3",
				"join3, select5 join({MS Zoning} == id,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join4",
				"join4, select2 join({MS SubClass} == {code MsSubClass},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join5",
				"select7 derive(each(match(type=='integer'), $$ = iifNull($$, 0)),",
				"          each(match(type=='string'), $$ = iifNull($$, 'NA')),",
				"          each(match(type=='long'), $$ = iifNull($$, 0))) ~> LimpiezaNulos",
				"DSNeonMsSubClass select(mapColumn(",
				"          {description MsSubClass} = description,",
				"          {code MsSubClass} = code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"DSNeonFloorDetail select(mapColumn(",
				"          PID = pid,",
				"          Floor,",
				"          bedrooms,",
				"          {Full Bath},",
				"          {Half Bath}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3",
				"DSNeonSaleProperty select(mapColumn(",
				"          PID = pid,",
				"          {Sale Date},",
				"          {Sale Type},",
				"          {Sale Condition},",
				"          saleprice",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4",
				"DSNeonMsZooning select(mapColumn(",
				"          id,",
				"          {description MsZoning} = description,",
				"          {code MsZoning} = code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select5",
				"DSNeonamesdbtemp select(mapColumn(",
				"          {Exter Cond},",
				"          {Exter Qual},",
				"          {Heating QC},",
				"          {Kitchen Qual},",
				"          {MS Zoning},",
				"          PID = pid,",
				"          {Roof Style},",
				"          {Roof Matl},",
				"          {Exterior 1st},",
				"          {Exterior 2nd},",
				"          {Mas Vnr Type},",
				"          {Mas Vnr Area},",
				"          foundation,",
				"          heating,",
				"          {Central Air},",
				"          electrical,",
				"          {1st Flr SF},",
				"          {2nd Flr SF},",
				"          {Low Qual Fin SF},",
				"          {Kitchen AbvGr},",
				"          {TotRms AbvGrd},",
				"          functional,",
				"          fireplaces,",
				"          {Fireplace Qu},",
				"          {Paved Drive},",
				"          {Wood Deck SF},",
				"          {Open Porch SF},",
				"          {Enclosed Porch},",
				"          {3Ssn Porch},",
				"          {Screen Porch},",
				"          fence,",
				"          {MS SubClass}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select6",
				"join5 select(mapColumn(",
				"          PID = cast1@PID,",
				"          {Lot Frontage},",
				"          {Lot Area},",
				"          Street,",
				"          Alley,",
				"          {Lot Shape},",
				"          {Land Contour},",
				"          Utilities,",
				"          {Lot Config},",
				"          {Land Slope},",
				"          Neighborhood,",
				"          {Condition 1},",
				"          {Condition 2},",
				"          {Bldg Type},",
				"          {House Style},",
				"          {Overall Qual},",
				"          {Overall Cond},",
				"          {Year Built},",
				"          {Year Remod/Add},",
				"          {Exter Cond},",
				"          {Exter Qual},",
				"          {Heating QC},",
				"          {Kitchen Qual},",
				"          {MS Zoning},",
				"          {Roof Style},",
				"          {Roof Matl},",
				"          {Exterior 1st},",
				"          {Exterior 2nd},",
				"          {Mas Vnr Type},",
				"          {Mas Vnr Area},",
				"          foundation,",
				"          heating,",
				"          {Central Air},",
				"          electrical,",
				"          {1st Flr SF},",
				"          {2nd Flr SF},",
				"          {Low Qual Fin SF},",
				"          {Kitchen AbvGr},",
				"          {TotRms AbvGrd},",
				"          functional,",
				"          fireplaces,",
				"          {Fireplace Qu},",
				"          {Paved Drive},",
				"          {Wood Deck SF},",
				"          {Open Porch SF},",
				"          {Enclosed Porch},",
				"          {3Ssn Porch},",
				"          {Screen Porch},",
				"          fence,",
				"          {MS SubClass},",
				"          {Sale Date},",
				"          {Sale Type},",
				"          {Sale Condition},",
				"          saleprice,",
				"          TotalFullBath,",
				"          TotalHalfBath,",
				"          TotalBedrooms,",
				"          id,",
				"          {description MsZoning},",
				"          {code MsZoning},",
				"          {description MsSubClass},",
				"          {code MsSubClass}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select7",
				"LimpiezaNulos derive({Gr Liv Area} = {1st Flr SF} + {2nd Flr SF} + {Low Qual Fin SF},",
				"          {Mo Sold} = month({Sale Date}),",
				"          {Yr Sold} = year({Sale Date}),",
				"          {Year Remod/Add} = iif({Year Remod/Add} == 0, {Year Built}, {Year Remod/Add})) ~> Transformaciones",
				"Transformaciones sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}